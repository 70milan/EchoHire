<!doctype html>
<html>
  <head><meta charset="utf-8"><title>Interview Assistant</title></head>
  <body>
    <h3>Interview Assistant</h3>
    <button id="recordBtn">ğŸ™ï¸ Capture Audio</button>
    <pre id="output"></pre>
 <script>
const output = document.getElementById('output');
const btn = document.getElementById('recordBtn');
let recording = false;

btn.onclick = async () => {
  if (!recording) {
    // --- Start recording ---
    output.innerText = 'ğŸ™ï¸ Recording...';
    btn.innerText = 'ğŸ›‘ Stop';
    recording = true;
    await fetch('http://127.0.0.1:5050/start?mode=mic');
  } else {
    // --- Stop recording ---
    output.innerText = 'â³ Transcribing...';
    btn.innerText = 'ğŸ™ï¸ Capture Audio';
    recording = false;

    // 1ï¸âƒ£ Get the transcript from backend
    const stopResp = await fetch('http://127.0.0.1:5050/stop');
    const stopData = await stopResp.json();
    const transcript = stopData.transcript || '';

    // 2ï¸âƒ£ Show transcript
    output.innerText = `ğŸ—£ï¸ Transcript:\n${transcript}\n\nğŸ¤– Generating AI reply...`;

    // 3ï¸âƒ£ Ask backend AI to generate an answer
    const aiResp = await fetch('http://127.0.0.1:5050/ai', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ transcript, role: 'data engineer' })
    });
    const aiData = await aiResp.json();

    // 4ï¸âƒ£ Show both transcript + AI answer
    output.innerText =
      `ğŸ—£ï¸ Transcript:\n${transcript}\n\nğŸ’¡ Suggested Answer:\n${aiData.answer}`;
  }
};
</script>
  </body>
</html>
